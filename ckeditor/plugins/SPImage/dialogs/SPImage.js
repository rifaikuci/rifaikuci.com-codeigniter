CKEDITOR.dialog.add("SPImageDialog",function(b){return{title:"Insert Image from SharePoint",minWidth:400,minHeight:200,contents:[{id:"SPimgSettings",label:"Image Settings",elements:[{type:"text",id:"imgSrc",label:"Image Source: *",validate:CKEDITOR.dialog.validate.notEmpty("Image Source field cannot be empty")},{type:"button",id:"brsButton",label:"Browse",title:"Browse",style:"float:right",onClick:function(){var a=CKEDITOR.dialog.getCurrent();with(new AssetPickerConfig("spAssetPickerObj"))DefaultAssetImageLocation=
"",CurrentWebBaseUrl=window._spPageContextInfo.webAbsoluteUrl,AssetTextClientID=AssetUrlClientID=OverrideDialogImageUrl=OverrideDialogDesc=OverrideDialogTitle=OverrideDialogFeatures="",DisplayLookInSection=DefaultToLastUsedLocation=UseImageAssetPicker=!0,ReturnCallback=function(b){a.setValueOf("SPimgSettings","imgSrc",b)};APD_LaunchAssetPickerUseConfigCurrentUrl("spAssetPickerObj")}},{type:"text",id:"imgWidth",label:"Width:",maxLength:5,inputStyle:"width:50px",validate:function(){if(this.getValue()&&
isNaN(parseFloat(this.getValue())))return alert("Width must be numeric."),!1}},{type:"text",id:"imgHeight",label:"Height:",maxLength:5,inputStyle:"width:50px",validate:function(){if(this.getValue()&&isNaN(parseFloat(this.getValue())))return alert("Height must be numeric."),!1}}]}],onShow:function(){$("div.cke_dialog_background_cover").css("z-index",1501);$("table.cke_dialog.cke_ltr.cke_single_page").css("z-index",1502)},onOk:function(){var a=b.document.createElement("img");a.setAttribute("src",this.getValueOf("SPimgSettings",
"imgSrc"));""!=this.getValueOf("SPimgSettings","imgHeight")&&a.setAttribute("height",this.getValueOf("SPimgSettings","imgHeight"));""!=this.getValueOf("SPimgSettings","imgWidth")&&a.setAttribute("width",this.getValueOf("SPimgSettings","imgWidth"));b.insertElement(a)}}});